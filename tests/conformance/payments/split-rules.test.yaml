test_suite: "Payments Service - Split Rules"
version: "1.0.0"
tests:
  - name: "Create Split Rule"
    description: "Create a revenue split rule for content monetization"
    steps:
      - request:
          method: POST
          path: /v1/payments/splits
          headers:
            Authorization: "Bearer test-jwt-token"
          body:
            content_id: "content-123"
            splits:
              - recipient_did: "did:ra:creator-123"
                percentage: 70
                type: "creator"
              - recipient_did: "did:ra:platform-123"
                percentage: 30
                type: "platform"
        expected_response:
          status: 201
          body:
            data:
              id: "^[a-zA-Z0-9-]+$"
              content_id: "content-123"
              splits:
                - recipient_did: "did:ra:creator-123"
                  percentage: 70
                  type: "creator"
                - recipient_did: "did:ra:platform-123"
                  percentage: 30
                  type: "platform"
              created_at: "^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"

  - name: "Apply Split Rule to Payment"
    description: "Apply split rules when processing a payment"
    steps:
      - request:
          method: POST
          path: /v1/payments/intents
          headers:
            Authorization: "Bearer test-jwt-token"
          body:
            amount: 1000
            currency: "USD"
            content_id: "content-123"
        expected_response:
          status: 201
          body:
            data:
              id: "^[a-zA-Z0-9-]+$"
              amount: 1000
              currency: "USD"
              status: "created"
              splits:
                - recipient_did: "did:ra:creator-123"
                  amount: 700
                  currency: "USD"
                - recipient_did: "did:ra:platform-123"
                  amount: 300
                  currency: "USD"
